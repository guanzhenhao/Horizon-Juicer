DEF REAL ZUIDU_DISTANCE,ZUIDU_SPEED,GRIND_DISTANCE,FULL_ANG;

WHEN $A_DBB[2]==1 DO DELDTG(AXNAME(G_0)) $R[280]=$AA_IM[AXNAME(G_0)] $R[281]=$AA_IM[AXNAME(G_1)];删除余程延时0.1s执行下面的
WHEN ($A_DBB[2]==1) AND ($A_DBB[19]==1) DO POS[AXNAME(G_0)]=0.2 FA[AXNAME(G_0)]=30;0.4秒后退0.2mm

GRIND_DISTANCE=GRIND[7]-GRIND[6];磨削全长
ZUIDU_DISTANCE=GRIND_DISTANCE*WORK[5]/2*ORI_G0;锥度距离
ZUIDU_SPEED=ABS(ZUIDU_DISTANCE/(GRIND_DISTANCE/TECH_0[4]));磨锥度速度
FULL_ANG=-GRIND_DISTANCE/WORK[4]*360*WORK[3];总角度

FGROUP(AXNAME(G_1));以台面速度为基准
POS[AXNAME(G_0)]=ZUIDU_DISTANCE FA[AXNAME(G_0)]=ZUIDU_SPEED G91 AX[AXNAME(G_1)]=GRIND_DISTANCE AX[AXNAME(G_2)]=FULL_ANG F=TECH_0[4];

STOPRE;
IF $A_DBB[2]==0;没按退刀键
    R280=$AA_IM[X];
    R281=$AA_IM[Z];
ENDIF;

RET;

